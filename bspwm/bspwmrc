#!/usr/bin/bash

# Start sxhkd if not already running
pgrep -x sxhkd > /dev/null || sxhkd &

# Define primary and secondary monitors
primary_monitor=$(xrandr --listmonitors | awk 'NR==2 {print $4}')
secondary_monitor=$(xrandr --listmonitors | awk 'NR==3 {print $4}')

# Set primary monitor and resolution
xrandr --output "$primary_monitor" --primary
xrandr --output "$primary_monitor" --mode 1920x1080 # <- your resolution

# Configure bspwm monitors and desktops
if [ -z "$primary_monitor" ] && [ -z "$secondary_monitor" ]; then
  bspc monitor -d 'α' 'β' 'γ' 'δ' 'ε' 'ζ' 'η' 'θ'
else
  if [ -z "$secondary_monitor" ]; then
    bspc monitor "$primary_monitor" -d 'α' 'β' 'γ' 'δ' 'ε' 'ζ' 'η' 'θ'
  else
    bspc monitor "$primary_monitor" -d 'α' 'β' 'γ' 'δ'
    bspc monitor "$secondary_monitor" -d 'ε' 'ζ' 'η' 'θ'
  fi
fi

# Configure bspwm settings
bspc config border_width         2
bspc config window_gap           7
bspc config split_ratio          0.52
bspc config borderless_monocle   true
bspc config gapless_monocle      true

# Define window rules
bspc rule -a Gimp desktop='^8' state=floating follow=on
bspc rule -a Chromium desktop='^2'
bspc rule -a mplayer2 state=floating
bspc rule -a Kupfer.py focus=on
bspc rule -a Screenkey manage=off

bspc config split_ratio          0.52
bspc config borderless_monocle   true
bspc config gapless_monocle      true

bspc rule -a Gimp desktop='^8' state=floating follow=on
bspc rule -a Chromium desktop='^2'
bspc rule -a mplayer2 state=floating
bspc rule -a Kupfer.py focus=on
bspc rule -a Screenkey manage=off

bspc config focused_border_color "$BLUE" 
bspc config normal_border_color "$BACKGROUND"
bspc config active_border_color "$MAGENTA"
bspc config presel_feedback_color "$GREEN"
bspc config paddingless_monocle true
bspc config single_monocle false
bspc config focus_follows_pointer true

# Launch polybar
~/.config/polybar/launch.sh &>/dev/null

# Set default cursor
xsetroot -cursor_name left_ptr & 

# Set the last wallpaper 
~/.fehbg
